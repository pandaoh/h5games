function enemys(){}enemys.prototype.init=function(){this.enemys={greenSlime:{name:"绿头怪",hp:50,atk:20,def:1,money:1,experience:1,special:0},redSlime:{name:"红头怪",hp:70,atk:15,def:2,money:2,experience:2,special:0},blackSlime:{name:"青头怪",hp:200,atk:35,def:10,money:5,experience:5,special:0},slimelord:{name:"怪王",hp:700,atk:250,def:125,money:32,experience:30,special:0},bat:{name:"小蝙蝠",hp:100,atk:20,def:5,money:3,experience:3,special:0},bigBat:{name:"大蝙蝠",hp:150,atk:65,def:30,money:10,experience:8,special:0},redBat:{name:"红蝙蝠",hp:550,atk:160,def:90,money:25,experience:20,special:0},vampire:{name:"冥灵魔王",hp:30000,atk:1700,def:1500,money:250,experience:220,special:0},vampire2:{name:"冥灵魔王",hp:45000,atk:2550,def:2250,money:312,experience:275,special:0},vampire3:{name:"冥灵魔王",hp:60000,atk:3400,def:3000,money:390,experience:343,special:0},skeleton:{name:"骷髅人",hp:110,atk:25,def:5,money:5,experience:4,special:0},skeletonSoilder:{name:"骷髅士兵",hp:150,atk:40,def:20,money:8,experience:6,special:0},skeletonCaptain:{name:"骷髅队长",hp:400,atk:90,def:50,money:15,experience:12,special:0},ghostSkeleton:{name:"冥队长",hp:2500,atk:900,def:850,money:84,experience:75,special:0},zombie:{name:"兽人",hp:300,atk:75,def:45,money:13,experience:10,special:0},zombieKnight:{name:"兽人武士",hp:900,atk:450,def:330,money:50,experience:50,special:0},rock:{name:"石头人",hp:500,atk:115,def:65,money:15,experience:15,special:0},slimeMan:{name:"影子战士",hp:3100,atk:1150,def:1050,money:92,experience:80,special:0},bluePriest:{name:"初级法师",hp:125,atk:50,def:25,money:10,experience:7,special:0},redPriest:{name:"高级法师",hp:100,atk:200,def:110,money:30,experience:25,special:0},brownWizard:{name:"麻衣法师",hp:250,atk:120,def:70,money:20,experience:17,special:22,damage:100},redWizard:{name:"红衣法师",hp:500,atk:400,def:260,money:47,experience:45,special:22,damage:300},yellowGuard:{name:"初级卫兵",hp:450,atk:150,def:90,money:22,experience:19,special:0},blueGuard:{name:"中级卫兵",hp:1250,atk:500,def:400,money:55,experience:55,special:0},redGuard:{name:"高级卫兵",hp:1500,atk:560,def:460,money:60,experience:60,special:0},swordsman:{name:"双手剑士",hp:1200,atk:620,def:520,money:65,experience:75,special:0},soldier:{name:"冥战士",hp:2000,atk:680,def:590,money:70,experience:65,special:0},yellowKnight:{name:"金骑士",hp:850,atk:350,def:200,money:45,experience:40,special:0},redKnight:{name:"金队长",hp:900,atk:750,def:650,money:77,experience:70,special:0},darkKnight:{name:"灵武士",hp:1200,atk:980,def:900,money:88,experience:75,special:0},blackKing:{name:"黑衣魔王",hp:1000,atk:500,def:0,money:1000,experience:1000,special:0,bomb:false},yellowKing:{name:"黄衣魔王",hp:0,atk:0,def:0,money:0,experience:0,special:0},greenKing:{name:"青衣武士",hp:0,atk:0,def:0,money:0,experience:0,special:0},blueKnight:{name:"蓝骑士",hp:100,atk:120,def:0,money:9,experience:0,special:8},goldSlime:{name:"黄头怪",hp:0,atk:0,def:0,money:0,experience:0,special:0},poisonSkeleton:{name:"紫骷髅",hp:0,atk:0,def:0,money:0,experience:0,special:0},poisonBat:{name:"紫蝙蝠",hp:100,atk:120,def:0,money:14,experience:0,special:13},steelRock:{name:"铁面人",hp:0,atk:0,def:0,money:0,experience:0,special:0},skeletonPriest:{name:"骷髅法师",hp:100,atk:100,def:0,money:0,experience:0,special:18,value:20},skeletonKing:{name:"骷髅王",hp:0,atk:0,def:0,money:0,experience:0,special:0},skeletonWizard:{name:"骷髅巫师",hp:0,atk:0,def:0,money:0,experience:0,special:0},redSkeletonCaption:{name:"骷髅武士",hp:0,atk:0,def:0,money:0,experience:0,special:0},badHero:{name:"迷失勇者",hp:0,atk:0,def:0,money:0,experience:0,special:0},demon:{name:"魔神武士",hp:0,atk:0,def:0,money:0,experience:0,special:0},demonPriest:{name:"魔神法师",hp:0,atk:0,def:0,money:0,experience:0,special:0},goldHornSlime:{name:"金角怪",hp:0,atk:0,def:0,money:0,experience:0,special:0},redKing:{name:"红衣魔王",hp:15000,atk:1000,def:1000,money:100,experience:100,special:0},redKing2:{name:"红衣魔王",hp:20000,atk:1333,def:1333,money:133,experience:133,special:0},whiteKing:{name:"白衣武士",hp:1300,atk:300,def:150,money:40,experience:35,special:11,value:1/4},blackMagician:{name:"灵法师",hp:1500,atk:830,def:730,money:80,experience:70,special:11,value:1/3},silverSlime:{name:"银头怪",hp:100,atk:120,def:0,money:15,experience:0,special:14},swordEmperor:{name:"剑圣",hp:0,atk:0,def:0,money:0,experience:0,special:0},whiteHornSlime:{name:"尖角怪",hp:0,atk:0,def:0,money:0,experience:0,special:0},badPrincess:{name:"痛苦魔女",hp:0,atk:0,def:0,money:0,experience:0,special:0},badFairy:{name:"黑暗仙子",hp:0,atk:0,def:0,money:0,experience:0,special:0},grayPriest:{name:"中级法师",hp:0,atk:0,def:0,money:0,experience:0,special:0},redSwordsman:{name:"剑王",hp:100,atk:120,def:0,money:7,experience:0,special:6,n:8},whiteGhost:{name:"水银战士",hp:0,atk:0,def:0,money:0,experience:0,special:0},poisonZombie:{name:"绿兽人",hp:100,atk:120,def:0,money:13,experience:0,special:12},magicDragon:{name:"魔龙",hp:99999,atk:9999,def:5000,money:0,experience:0,special:0},octopus:{name:"血影",hp:99999,atk:5000,def:4000,money:0,experience:0,special:0},darkFairy:{name:"仙子",hp:0,atk:0,def:0,money:0,experience:0,special:0},greenKnight:{name:"强盾骑士",hp:0,atk:0,def:0,money:0,experience:0,special:0},}};enemys.prototype.getEnemys=function(a){if(!core.isset(a)){return this.enemys}return this.enemys[a]};enemys.prototype.update=function(){var a=core.material.enemys;if(core.getFlag("change",0)==1){a.ghostSkeleton.hp=3333;a.ghostSkeleton.atk=1200;a.ghostSkeleton.def=1133;a.ghostSkeleton.money=112;a.ghostSkeleton.experience=100;a.darkKnight.hp=1600;a.darkKnight.atk=1306;a.darkKnight.def=1200;a.darkKnight.money=117;a.darkKnight.experience=100;a.blackMagician.hp=2000;a.blackMagician.atk=1106;a.blackMagician.def=973;a.blackMagician.money=106;a.blackMagician.experience=93}else{if(core.getFlag("change",0)==2){a.redKing2.hp=30000;a.redKing2.atk=2666;a.redKing2.def=2666;a.redKing2.money=166;a.redKing2.experience=166;a.ghostSkeleton.hp=4999;a.ghostSkeleton.atk=2400;a.ghostSkeleton.def=2266;a.ghostSkeleton.money=140;a.ghostSkeleton.experience=125;a.darkKnight.hp=2400;a.darkKnight.atk=2612;a.darkKnight.def=2400;a.darkKnight.money=146;a.darkKnight.experience=125;a.blackMagician.hp=3000;a.blackMagician.atk=2212;a.blackMagician.def=1946;a.blackMagician.money=132;a.blackMagician.experience=116}}};enemys.prototype.hasSpecial=function(a,b){if(a instanceof Array){return a.indexOf(b)>=0}if(typeof a=="number"){return a!=0&&(a%100==b||this.hasSpecial(parseInt(a/100),b))}return false};enemys.prototype.getSpecialText=function(b){if(b==undefined){return""}var a=this.enemys[b];var c=a.special;var d=[];if(this.hasSpecial(c,1)){d.push("先攻")}if(this.hasSpecial(c,2)){d.push("魔攻")}if(this.hasSpecial(c,3)){d.push("坚固")}if(this.hasSpecial(c,4)){d.push("2连击")}if(this.hasSpecial(c,5)){d.push("3连击")}if(this.hasSpecial(c,6)){d.push((a.n||4)+"连击")}if(this.hasSpecial(c,7)){d.push("破甲")}if(this.hasSpecial(c,8)){d.push("反击")}if(this.hasSpecial(c,9)){d.push("净化")}if(this.hasSpecial(c,10)){d.push("模仿")}if(this.hasSpecial(c,11)){d.push("吸血")}if(this.hasSpecial(c,12)){d.push("中毒")}if(this.hasSpecial(c,13)){d.push("衰弱")}if(this.hasSpecial(c,14)){d.push("诅咒")}if(this.hasSpecial(c,15)){d.push("领域")}if(this.hasSpecial(c,16)){d.push("夹击")}if(this.hasSpecial(c,17)){d.push("仇恨")}if(this.hasSpecial(c,18)){d.push("阻击")}if(this.hasSpecial(c,19)){d.push("自爆")}if(this.hasSpecial(c,20)){d.push("无敌")}if(this.hasSpecial(c,21)){d.push("退化")}if(this.hasSpecial(c,22)){d.push("固伤")}return d};enemys.prototype.getSpecialHint=function(a,e){if(!core.isset(e)){var c=[];for(var d=1;d<100;d++){if(this.hasSpecial(a.special,d)){var b=this.getSpecialHint(a,d);if(b!=""){c.push(b)}}}return c}switch(e){case 1:return"先攻：怪物首先攻击";case 2:return"魔攻：怪物无视勇士的防御";case 3:return"坚固：勇士每回合最多只能对怪物造成1点伤害";case 4:return"2连击：怪物每回合攻击2次";case 5:return"3连击：怪物每回合攻击3次";case 6:return(a.n||4)+"连击： 怪物每回合攻击"+(a.n||4)+"次";case 7:return"破甲：战斗前，怪物附加角色防御的"+parseInt(100*core.values.breakArmor)+"%作为伤害";case 8:return"反击：战斗时，怪物每回合附加角色攻击的"+parseInt(100*core.values.counterAttack)+"%作为伤害，无视角色防御";case 9:return"净化：战斗前，怪物附加勇士魔防的"+core.values.purify+"倍作为伤害";case 10:return"模仿：怪物的攻防和勇士攻防相等";case 11:return"吸血：战斗前，怪物首先吸取角色的"+parseInt(100*a.value)+"%生命作为伤害"+(a.add?"，并把伤害数值加到自身生命上":"");case 12:return"中毒：战斗后，勇士陷入中毒状态，每一步损失生命"+core.values.poisonDamage+"点";case 13:return"衰弱：战斗后，勇士陷入衰弱状态，攻防暂时下降"+core.values.weakValue+"点";case 14:return"诅咒：战斗后，勇士陷入诅咒状态，战斗无法获得金币和经验";case 15:return"领域：经过怪物周围"+(a.range||1)+"格时自动减生命"+(a.value||0)+"点";case 16:return"夹击：经过两只相同的怪物中间，勇士生命值变成一半";case 17:return"仇恨：战斗前，怪物附加之前积累的仇恨值作为伤害"+(core.flags.hatredDecrease?"；战斗后，释放一半的仇恨值":"")+"。（每杀死一个怪物获得"+core.values.hatred+"点仇恨值）";case 18:return"阻击：经过怪物的十字领域时自动减生命"+(a.value||0)+"点，同时怪物后退一格";case 19:return"自爆：战斗后勇士的生命值变成1";case 20:return"无敌：勇士无法打败怪物，除非拥有十字架";case 21:return"退化：战斗后勇士永久下降"+(a.atkValue||0)+"点攻击和"+(a.defValue||0)+"点防御";case 22:return"固伤：战斗前，怪物对勇士造成"+(a.damage||0)+"点固定伤害，无视勇士魔防。";default:break}return""};enemys.prototype.getDamage=function(c){var b=core.material.enemys[c];var a=this.calDamage(b,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef);if(a>=999999999){return a}return a+this.getExtraDamage(b)};enemys.prototype.getExtraDamage=function(b){var a=0;if(this.hasSpecial(b.special,17)){a+=core.getFlag("hatred",0)}if(this.hasSpecial(b.special,22)){a+=b.damage||0}return a};enemys.prototype.getCritical=function(e){var d=core.material.enemys[e];if(this.hasSpecial(d.special,3)||this.hasSpecial(d.special,10)){return"???"}var c=this.calDamage(d,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef);if(c<=0){return 0}for(var b=core.status.hero.atk+1;b<=d.hp+d.def;b++){var a=this.calDamage(d,core.status.hero.hp,b,core.status.hero.def,core.status.hero.mdef);if(a<c){return b-core.status.hero.atk}c=a}return 0};enemys.prototype.getCriticalDamage=function(e){var a=this.getCritical(e);if(a=="???"){return"???"}if(a<=0){return 0}var d=core.material.enemys[e];var b=this.calDamage(d,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef);if(b>=999999999){return"???"}return b-this.calDamage(d,core.status.hero.hp,core.status.hero.atk+a,core.status.hero.def,core.status.hero.mdef)};enemys.prototype.getDefDamage=function(b){var a=core.material.enemys[b];var d=this.calDamage(a,core.status.hero.hp,core.status.hero.atk,core.status.hero.def,core.status.hero.mdef);var c=this.calDamage(a,core.status.hero.hp,core.status.hero.atk,core.status.hero.def+1,core.status.hero.mdef);if(d>=999999999||c>=999999999){return"???"}return d-c};enemys.prototype.calDamage=function(l,e,c,d,f){var j=l.hp,h=l.atk,i=l.def,k=l.special;if(this.hasSpecial(k,20)&&!core.hasItem("cross")){return 999999999}var g=0;if(this.hasSpecial(k,11)){var o=e*l.value;o=parseInt(o);if(l.add){j+=o}g+=o}if(this.hasSpecial(k,10)){h=c;i=d}if(this.hasSpecial(k,2)){d=0}if(this.hasSpecial(k,3)&&i<c-1){i=c-1}if(c<=i){return 999999999}var m=h-d;if(m<0){m=0}if(this.hasSpecial(k,4)){m*=2}if(this.hasSpecial(k,5)){m*=3}if(this.hasSpecial(k,6)){m*=(l.n||4)}var b=0;if(this.hasSpecial(k,8)){b+=parseInt(core.values.counterAttack*c)}if(this.hasSpecial(k,1)){g+=m}if(this.hasSpecial(k,7)){g+=parseInt(core.values.breakArmor*d)}if(this.hasSpecial(k,9)){g+=parseInt(core.values.purify*f)}var n=parseInt((j-1)/(c-i));var a=g+n*m+(n+1)*b;a-=f;if(!core.flags.enableNegativeDamage){a=Math.max(0,a)}return a};enemys.prototype.getCurrentEnemys=function(d){d=d||core.status.floorId;var c=[];var l={};var e=core.status.maps[d].blocks;for(var a=0;a<e.length;a++){if(core.isset(e[a].event)&&!(core.isset(e[a].enable)&&!e[a].enable)&&e[a].event.cls=="enemys"){var j=e[a].event.id;if(core.isset(l[j])){continue}var i=core.material.enemys[j];var h=i.hp,f=i.atk,g=i.def;if(this.hasSpecial(i.special,3)&&g<core.status.hero.atk-1){g=core.status.hero.atk-1}if(this.hasSpecial(i.special,10)){f=core.status.hero.atk;g=core.status.hero.def}var k=core.enemys.getSpecialText(j);if(k.length>=3){k="多属性..."}else{k=k.join("  ")}c.push({id:j,name:i.name,hp:h,atk:f,def:g,money:i.money,experience:i.experience,point:i.point||0,special:k,damage:this.getDamage(j),critical:this.getCritical(j),criticalDamage:this.getCriticalDamage(j),defDamage:this.getDefDamage(j)});l[j]=true}}c.sort(function(m,n){if(m.damage==n.damage){return m.money-n.money}return m.damage-n.damage});return c};main.instance.enemys=new enemys();